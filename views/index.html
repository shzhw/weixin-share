<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
  </head>

  <body>
    hello world!!
    <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <script>
      console.log(encodeURIComponent(location.href.split('#')[0]));
      $.get('/sendurl?oriurl=' + encodeURIComponent(location.href.split('#')[0]), function (data) {
        wx.config({
          debug: true,
          appId: data.appid,
          timestamp: data.timestamp,
          nonceStr: data.nonceStr,
          signature: data.signature,
          jsApiList: [
            'onMenuShareTimeline',
            'onMenuShareAppMessage'
          ]
        });
        wx.ready(function () {
          var sdata = {
            title: '那年|时光遗忘了，文字却清晰地复刻着',
            desc: '那年|时光遗忘了，文字却清晰地复刻着',
            link: 'http://game.4gshu.com/deep-love/index2.html',
            imgUrl: 'http://game.4gshu.com/xuangedan/other-project/2015-01-06/img/share-wx-logo.jpg',
            success: function () {
              alert('用户确认分享后执行的回调函数');
            },
            cancel: function () {
              alert('用户取消分享后执行的回调函数');
            }
          };
          wx.onMenuShareTimeline(sdata);
          // wx.onMenuShareAppMessage(sdata);
        });
        wx.error(function (res) {
          // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
        });

      });
    </script>
  </body>

</html>
